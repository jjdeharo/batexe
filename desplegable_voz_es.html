<link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet"  type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible&display=swap" rel="stylesheet" type="text/css">
<link href="https://fonts.cdnfonts.com/css/opendyslexic" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet"  type="text/css">


<style>
  .font-button {
    padding: 8px 16px;
    border: 1px solid black;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    margin: 8px;
    text-align: center;
    text-decoration: none;
    background-color: white;
  }

  .fontButtonContainer {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap; /* establece el wrap para que los botones se distribuyan en varias líneas */
    gap: 5px; /* ajusta el espacio entre los botones */
  }
  
  /* Estilo para el desplegable */
  select {
    padding: 8px 16px;
    border: 1px solid black;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    margin: 8px;
    text-align: center;
    text-decoration: none;
    background-color: white;
  }
</style>

<script>

  // Define el texto que se ve en pantalla
  // Reemplazar el texto entre comillas
  const standardText = 'Fuente estándar'; // Desplegable
  const dyslexicText = 'OpenDyslexic'; // Desplegable
  const hyperlegibleText = 'Atkinson Hyperlegible'; // Desplegable
  const opensansText = 'OpenSans'; // Desplegable
  const robotoText = 'Roboto'; // Desplegable
  const latoText = 'Lato'; // Desplegable
  const increaseFontText = '+'; // Botón para incrementar la fuente
  const decreaseFontText = '-'; // Botón para reducir la fuente
  const infoText = '+Info'; // Texto del enlace +Info
  const infoTextLink = 'https://batexe.bilateria.org'; // Destino del enlace de +Info
  const readText = 'Leer'; // Botón para leer en voz alta el contenido de la página
  const stopText = 'Detener'; // Botón para deterner la lectura


  let originalFont;
  let currentFontSize;
  let originalFontSize;
  let isReading = false;
  let utterance = new SpeechSynthesisUtterance();

  function setFont(font) {
  document.body.style.fontFamily = font;
  localStorage.setItem('font', font);
  }

  function setFontSize(size) {
  currentFontSize = parseInt(window.getComputedStyle(document.body).getPropertyValue('font-size'));
  currentFontSize += size;
  document.body.style.fontSize = currentFontSize + 'px';
  localStorage.setItem('fontSize', currentFontSize + 'px');
  }

  document.addEventListener('DOMContentLoaded', () => {
  originalFont = window.getComputedStyle(document.body).getPropertyValue('font-family');
  localStorage.setItem('originalFont', originalFont);
  let font = localStorage.getItem('font');
  if (!font) {
  font = originalFont;
  }
  document.body.style.fontFamily = font;
  
  let fontSize = localStorage.getItem('fontSize');
  originalFontSize = window.getComputedStyle(document.body).getPropertyValue('font-size');
  localStorage.setItem('originalFontSize', originalFontSize);
  if (!fontSize) {     
    fontSize = originalFontSize
    localStorage.setItem('fontSize', fontSize);
  }
  document.body.style.fontSize = fontSize;

  const fontButtonContainer = document.createElement('div');
  fontButtonContainer.classList.add('fontButtonContainer'); // utiliza una clase en lugar de los estilos directamente

  const selectContainer = document.createElement('div');
  selectContainer.classList.add('select-container');
  const select = document.createElement('select');

  const standardOption = document.createElement('option');
  standardOption.value = 'standard';
  standardOption.text = standardText;
  select.add(standardOption);

  const dyslexicOption = document.createElement('option');
  dyslexicOption.value = 'dyslexic';
  dyslexicOption.text = dyslexicText;
  select.add(dyslexicOption);

  const hyperlegibleOption = document.createElement('option');
  hyperlegibleOption.value = 'hyperlegible';
  hyperlegibleOption.text = hyperlegibleText;
  select.add(hyperlegibleOption);

  const opensansOption = document.createElement('option');
  opensansOption.value = 'OpenSans';
  opensansOption.text = opensansText;
  select.add(opensansOption);

  const robotoOption = document.createElement('option');
  robotoOption.value = 'Roboto';
  robotoOption.text = robotoText;
  select.add(robotoOption);

  const latoOption = document.createElement('option');
  latoOption.value = 'Lato';
  latoOption.text = latoText;
  select.add(latoOption);

  // Seleccionar la opción correspondiente al cargar la página
  if (font === 'OpenDyslexic') {
  select.selectedIndex = 1;
  } else if (font === 'Atkinson Hyperlegible') {
  select.selectedIndex = 2;
  } else if (font === 'OpenSans') {
  select.selectedIndex = 3;
  } else if (font === 'Roboto') {
  select.selectedIndex = 4;
  } else if (font === 'Lato') {
  select.selectedIndex = 5;
  }

  select.addEventListener('change', () => {
  const font = select.value;
  if (font === 'standard') {
  setFont(originalFont);
  fontSize = originalFontSize;
  localStorage.setItem('fontSize', fontSize);
  document.body.style.fontSize = localStorage.getItem('originalFontSize');
  } else if (font === 'dyslexic') {
  setFont('OpenDyslexic');
  } else if (font === 'hyperlegible') {
  setFont('Atkinson Hyperlegible');
  } else if (font === 'OpenSans') {
  setFont('Open Sans');
  } else if (font === 'Roboto') {
  setFont('Roboto');
  } else if (font === 'Lato') {
  setFont('Lato');
  }
  });

  selectContainer.appendChild(select);
  fontButtonContainer.appendChild(selectContainer);

  const increaseFontButton = document.createElement('button');
  increaseFontButton.classList.add('font-button');
  increaseFontButton.textContent = increaseFontText;
  increaseFontButton.addEventListener('click', () => setFontSize(3));
  fontButtonContainer.appendChild(increaseFontButton);

  const decreaseFontButton = document.createElement('button');
  decreaseFontButton.classList.add('font-button');
  decreaseFontButton.textContent = decreaseFontText;
  decreaseFontButton.addEventListener('click', () => setFontSize(-3));
  fontButtonContainer.appendChild(decreaseFontButton);

  const infoLink = document.createElement('a');
  infoLink.textContent = infoText;
  infoLink.href = infoTextLink;
  infoLink.target = '_blank';
  infoLink.style.marginLeft = '8px';
  infoLink.style.fontSize = '12px';
  fontButtonContainer.appendChild(infoLink);

  const readButton = document.createElement('button');
  readButton.classList.add('font-button');
  readButton.textContent = readText;
  readButton.addEventListener('click', () => {
  let selectedText = window.getSelection().toString();
  if (selectedText !== '') {
  utterance.text = selectedText;
  } else {
  utterance.text = document.body.innerText;
  }
  if (!isReading) {
  isReading = true;
  readButton.textContent = stopText;
  speechSynthesis.speak(utterance);
  } else {
  isReading = false;
  readButton.textContent = readText;
  speechSynthesis.cancel();
  }
  });

  fontButtonContainer.insertBefore(readButton, infoLink);

  document.body.insertBefore(fontButtonContainer, document.body.firstChild);
  });
</script>
